!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){}d.prototype={isAsync:function(){return"undefined"==typeof this.decodeBlock}},b.exports=d},{}],2:[function(a,b,c){"use strict";function d(){}var e=a("../abstractdecoder.js");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.decodeBlockAsync=function(a,b){throw new Error("DeflateDecoder is not yet implemented.")},b.exports=d},{"../abstractdecoder.js":1}],3:[function(a,b,c){"use strict";function d(){this.littleEndian=!1,this.position=0,this._makeEntryLookup=!1,this.dictionary=[]}function e(){this.decompressor=new d}var f=a("../abstractdecoder.js"),g=9,h=12,i=256,j=257;d.prototype={constructor:d,initDictionary:function(){this.dictionary=new Array(258),this.entryLookup={},this.byteLength=g;for(var a=0;a<=257;a++)this.dictionary[a]=[a],this._makeEntryLookup&&(this.entryLookup[a]=a)},decompress:function(a){this._makeEntryLookup=!1,this.initDictionary(),this.position=0,this.result=[],a.buffer||(a=new Uint8Array(a));for(var b,c=new DataView(a.buffer),d=this.getNext(c);d!==j;){if(d===i){for(this.initDictionary(),d=this.getNext(c);d===i;)d=this.getNext(c);if(d>i)throw"corrupted code at scanline "+d;if(d===j)break;var e=this.dictionary[d];this.appendArray(this.result,e),b=d}else if(void 0!==this.dictionary[d]){var f=this.dictionary[d];this.appendArray(this.result,f);var g=this.dictionary[b].concat(this.dictionary[d][0]);this.addToDictionary(g),b=d}else{var h=this.dictionary[b];if(!h)throw"Bogus entry. Not in dictionary, "+b+" / "+this.dictionary.length+", position: "+this.position;var k=h.concat(this.dictionary[b][0]);this.appendArray(this.result,k),this.addToDictionary(k),b=d}this.dictionary.length>=Math.pow(2,this.byteLength)-1&&this.byteLength++,d=this.getNext(c)}return new Uint8Array(this.result)},appendArray:function(a,b){for(var c=0;c<b.length;c++)a.push(b[c]);return a},haveBytesChanged:function(){return this.dictionary.length>=Math.pow(2,this.byteLength)&&(this.byteLength++,!0)},addToDictionary:function(a){return this.dictionary.push(a),this._makeEntryLookup&&(this.entryLookup[a]=this.dictionary.length-1),this.haveBytesChanged(),this.dictionary.length-1},getNext:function(a){var b=this.getByte(a,this.position,this.byteLength);return this.position+=this.byteLength,b},getByte:function(a,b,c){var d=b%8,e=Math.floor(b/8),f=8-d,g=b+c-8*(e+1),h=8*(e+2)-(b+c),i=8*(e+2)-b;if(h=Math.max(0,h),e>=a.byteLength)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),j;var k=a.getUint8(e,this.littleEndian)&Math.pow(2,8-d)-1;k<<=c-f;var l=k;if(e+1<a.byteLength){var m=a.getUint8(e+1,this.littleEndian)>>>h;m<<=Math.max(0,c-i),l+=m}if(g>8&&e+2<a.byteLength){var n=8*(e+3)-(b+c),o=a.getUint8(e+2,this.littleEndian)>>>n;l+=o}return l},compress:function(a){this._makeEntryLookup=!0,this.initDictionary(),this.position=0;var b=[],c=[];b=this.appendArray(b,this.binaryFromByte(i,this.byteLength));for(var d=0;d<a.length;d++){var e=[a[d]],f=c.concat(e);if(void 0!==this.entryLookup[f])c=f;else{var g=this.entryLookup[c],k=this.binaryFromByte(g,this.byteLength);b=this.appendArray(b,k),this.addToDictionary(f),c=e,this.dictionary.length>=Math.pow(2,h)&&(b=this.appendArray(b,this.binaryFromByte(i,this.byteLength)),this.initDictionary())}}var l=this.entryLookup[c],m=this.binaryFromByte(l,this.byteLength);return b=this.appendArray(b,m),b=b=this.appendArray(b,this.binaryFromByte(j,this.byteLength)),this.binary=b,this.result=this.binaryToUint8(b),this.result},byteFromCode:function(a){var b=this.dictionary[a];return b},binaryFromByte:function(a){for(var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,c=new Uint8Array(b),d=0;d<c.length;d++){var e=Math.pow(2,d),f=(a&e)>0;c[c.length-1-d]=f}return c},binaryToNumber:function(a){for(var b=0,c=0;c<a.length;c++)b+=Math.pow(2,a.length-c-1)*a[c];return b},inputToBinary:function(a){for(var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,c=new Uint8Array(a.length*b),d=0;d<a.length;d++){var e=this.binaryFromByte(a[d],b);c.set(e,d*b)}return c},binaryToUint8:function(a){for(var b=new Uint8Array(Math.ceil(a.length/8)),c=0,d=0;d<a.length;d+=8){for(var e=0,f=0;f<8&&d+f<a.length;f++)e+=a[d+f]*Math.pow(2,8-f-1);b[c]=e,c++}return b}},e.prototype=Object.create(f.prototype),e.prototype.constructor=e,e.prototype.decodeBlock=function(a){return this.decompressor.decompress(a).buffer},b.exports=e},{"../abstractdecoder.js":1}],4:[function(a,b,c){"use strict";function d(){}var e=a("../abstractdecoder.js");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.decodeBlock=function(a){var b,c,d=new DataView(a),e=[];for(b=0;b<a.byteLength;++b){var f=d.getInt8(b);if(f<0){var g=d.getUint8(b+1);for(f=-f,c=0;c<=f;++c)e.push(g);b+=1}else{for(c=0;c<=f;++c)e.push(d.getUint8(b+c+1));b+=f+1}}return new Uint8Array(e).buffer},b.exports=d},{"../abstractdecoder.js":1}],5:[function(a,b,c){"use strict";function d(){}var e=a("../abstractdecoder.js");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.decodeBlock=function(a){return a},b.exports=d},{"../abstractdecoder.js":1}],6:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this._dataView=new DataView(b)}return e(a,[{key:"getUint64",value:function(a,b){var c=this.getUint32(a,b),d=this.getUint32(a+4,b);return b?c<<32|d:d<<32|c}},{key:"getInt64",value:function(a,b){var c,d;return b?(c=this.getInt32(a,b),d=this.getUint32(a+4,b),c<<32|d):(c=this.getUint32(a,b),d=this.getInt32(a+4,b),d<<32|c)}},{key:"getUint8",value:function(a,b){return this._dataView.getUint8(a,b)}},{key:"getInt8",value:function(a,b){return this._dataView.getInt8(a,b)}},{key:"getUint16",value:function(a,b){return this._dataView.getUint16(a,b)}},{key:"getInt16",value:function(a,b){return this._dataView.getInt16(a,b)}},{key:"getUint32",value:function(a,b){return this._dataView.getUint32(a,b)}},{key:"getInt32",value:function(a,b){return this._dataView.getInt32(a,b)}},{key:"getFloat32",value:function(a,b){return this._dataView.getFloat32(a,b)}},{key:"getFloat64",value:function(a,b){return this._dataView.getFloat64(a,b)}},{key:"buffer",get:function(){return this._dataView.buffer}}]),a}();b.exports=f},{}],7:[function(a,b,c){"use strict";function d(a,b){this.dataView=new g(a),b=b||{},this.cache=b.cache||!1;var c=this.dataView.getUint16(0,0);if(18761===c)this.littleEndian=!0;else{if(19789!==c)throw new TypeError("Invalid byte order value.");this.littleEndian=!1}var d=this.dataView.getUint16(2,this.littleEndian);if(42===this.dataView.getUint16(2,this.littleEndian))this.bigTiff=!1;else{if(43!==d)throw new TypeError("Invalid magic number.");this.bigTiff=!0;var e=this.dataView.getUint16(4,this.littleEndian);if(8!==e)throw new Error("Unsupported offset byte-size.")}this.fileDirectories=this.parseFileDirectories(this.getOffset(this.bigTiff?8:4))}var e=a("./globals.js"),f=a("./geotiffimage.js"),g=a("./dataview64.js"),h=e.fieldTypes,i=e.fieldTagNames,j=e.arrayFields,k=e.geoKeyNames;d.prototype={getOffset:function(a){return this.bigTiff?this.dataView.getUint64(a,this.littleEndian):this.dataView.getUint32(a,this.littleEndian)},getFieldTypeLength:function(a){switch(a){case h.BYTE:case h.ASCII:case h.SBYTE:case h.UNDEFINED:return 1;case h.SHORT:case h.SSHORT:return 2;case h.LONG:case h.SLONG:case h.FLOAT:return 4;case h.RATIONAL:case h.SRATIONAL:case h.DOUBLE:case h.LONG8:case h.SLONG8:case h.IFD8:return 8;default:throw new RangeError("Invalid field type: "+a)}},getValues:function(a,b,c){var d,e=null,f=null,g=this.getFieldTypeLength(a);switch(a){case h.BYTE:case h.ASCII:case h.UNDEFINED:e=new Uint8Array(b),f=this.dataView.getUint8;break;case h.SBYTE:e=new Int8Array(b),f=this.dataView.getInt8;break;case h.SHORT:e=new Uint16Array(b),f=this.dataView.getUint16;break;case h.SSHORT:e=new Int16Array(b),f=this.dataView.getInt16;break;case h.LONG:e=new Uint32Array(b),f=this.dataView.getUint32;break;case h.SLONG:e=new Int32Array(b),f=this.dataView.getInt32;break;case h.LONG8:case h.IFD8:e=new Array(b),f=this.dataView.getUint64;break;case h.SLONG8:e=new Array(b),f=this.dataView.getInt64;break;case h.RATIONAL:e=new Uint32Array(2*b),f=this.dataView.getUint32;break;case h.SRATIONAL:e=new Int32Array(2*b),f=this.dataView.getInt32;break;case h.FLOAT:e=new Float32Array(b),f=this.dataView.getFloat32;break;case h.DOUBLE:e=new Float64Array(b),f=this.dataView.getFloat64;break;default:throw new RangeError("Invalid field type: "+a)}if(a!==h.RATIONAL&&a!==h.SRATIONAL)for(d=0;d<b;++d)e[d]=f.call(this.dataView,c+d*g,this.littleEndian);else for(d=0;d<b;d+=2)e[d]=f.call(this.dataView,c+d*g,this.littleEndian),e[d+1]=f.call(this.dataView,c+(d*g+4),this.littleEndian);return a===h.ASCII?String.fromCharCode.apply(null,e):e},getFieldValues:function(a,b,c,d){var e,f=this.getFieldTypeLength(b);if(f*c<=(this.bigTiff?8:4))e=this.getValues(b,c,d);else{var g=this.getOffset(d);e=this.getValues(b,c,g)}return 1===c&&j.indexOf(a)===-1&&b!==h.RATIONAL&&b!==h.SRATIONAL?e[0]:e},parseGeoKeyDirectory:function(a){var b=a.GeoKeyDirectory;if(!b)return null;for(var c={},d=4;d<4*b[3];d+=4){var e=k[b[d]],f=b[d+1]?i[b[d+1]]:null,g=b[d+2],h=b[d+3],j=null;if(f){if(j=a[f],"undefined"==typeof j||null===j)throw new Error("Could not get value of geoKey '"+e+"'.");"string"==typeof j?j=j.substring(h,h+g-1):j.subarray&&(j=j.subarray(h,h+g-1))}else j=h;c[e]=j}return c},parseFileDirectories:function(a){for(var b=a,c=[];0!==b;){for(var d=this.bigTiff?this.dataView.getUint64(b,this.littleEndian):this.dataView.getUint16(b,this.littleEndian),e={},f=a+(this.bigTiff?8:2),g=0;g<d;f+=this.bigTiff?20:12,++g){var h=this.dataView.getUint16(f,this.littleEndian),j=this.dataView.getUint16(f+2,this.littleEndian),k=this.bigTiff?this.dataView.getUint64(f+4,this.littleEndian):this.dataView.getUint32(f+4,this.littleEndian);e[i[h]]=this.getFieldValues(h,j,k,f+(this.bigTiff?12:8))}c.push([e,this.parseGeoKeyDirectory(e)]),b=this.getOffset(f)}return c},getImage:function(a){a=a||0;var b=this.fileDirectories[a];if(!b)throw new RangeError("Invalid image index");return new f(b[0],b[1],this.dataView,this.littleEndian,this.cache)},getImageCount:function(){return this.fileDirectories.length}},b.exports=d},{"./dataview64.js":6,"./geotiffimage.js":8,"./globals.js":9}],8:[function(a,b,c){"use strict";function d(a,b,c,d,e){this.fileDirectory=a,this.geoKeys=b,this.dataView=c,this.littleEndian=d,this.tiles=e?{}:null,this.isTiled=!a.StripOffsets;var f=a.PlanarConfiguration;if(this.planarConfiguration="undefined"==typeof f?1:f,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");switch(this.fileDirectory.Compression){case void 0:case 1:this.decoder=new g;break;case 5:this.decoder=new h;break;case 6:throw new Error("JPEG compression not supported.");case 8:this.decoder=new i;break;case 32773:this.decoder=new j;break;default:throw new Error("Unknown compresseion method identifier: "+this.fileDirectory.Compression)}}var e=a("./globals.js"),f=a("./rgb.js"),g=a("./compression/raw.js"),h=a("./compression/lzw.js"),i=a("./compression/deflate.js"),j=a("./compression/packbits.js"),k=function(a,b,c){for(var d=0,e=b;e<c;++e)d+=a[e];return d},l=function(a,b,c){switch(a){case 1:switch(b){case 8:return new Uint8Array(c);case 16:return new Uint16Array(c);case 32:return new Uint32Array(c)}break;case 2:switch(b){case 8:return new Int8Array(c);case 16:return new Int16Array(c);case 32:return new Int32Array(c)}break;case 3:switch(b){case 32:return new Float32Array(c);case 64:return new Float64Array(c)}}throw Error("Unsupported data format/bitsPerSample")};d.prototype={getFileDirectory:function(){return this.fileDirectory},getGeoKeys:function(){return this.geoKeys},getWidth:function(){return this.fileDirectory.ImageWidth},getHeight:function(){return this.fileDirectory.ImageLength},getSamplesPerPixel:function(){return this.fileDirectory.SamplesPerPixel},getTileWidth:function(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()},getTileHeight:function(){return this.isTiled?this.fileDirectory.TileLength:this.fileDirectory.RowsPerStrip},getBytesPerPixel:function(){for(var a=0,b=0;b<this.fileDirectory.BitsPerSample.length;++b){var c=this.fileDirectory.BitsPerSample[b];if(c%8!==0)throw new Error("Sample bit-width of "+c+" is not supported.");if(c!==this.fileDirectory.BitsPerSample[0])throw new Error("Differing size of samples in a pixel are not supported.");a+=c}return a/8},getSampleByteSize:function(a){if(a>=this.fileDirectory.BitsPerSample.length)throw new RangeError("Sample index "+a+" is out of range.");var b=this.fileDirectory.BitsPerSample[a];if(b%8!==0)throw new Error("Sample bit-width of "+b+" is not supported.");return b/8},getReaderForSample:function(a){var b=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[a]:1,c=this.fileDirectory.BitsPerSample[a];switch(b){case 1:switch(c){case 8:return DataView.prototype.getUint8;case 16:return DataView.prototype.getUint16;case 32:return DataView.prototype.getUint32}break;case 2:switch(c){case 8:return DataView.prototype.getInt8;case 16:return DataView.prototype.getInt16;case 32:return DataView.prototype.getInt32}break;case 3:switch(c){case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}},getArrayForSample:function(a,b){var c=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[a]:1,d=this.fileDirectory.BitsPerSample[a];return l(c,d,b)},getDecoder:function(){return this.decoder},getTileOrStrip:function(a,b,c,d){var e,f=Math.ceil(this.getWidth()/this.getTileWidth()),g=Math.ceil(this.getHeight()/this.getTileHeight()),h=this.tiles;if(1===this.planarConfiguration?e=b*f+a:2===this.planarConfiguration&&(e=c*f*g+b*f+a),null!==h&&e in h)return d?d(null,{x:a,y:b,sample:c,data:h[e]}):h[e];var i,j;this.isTiled?(i=this.fileDirectory.TileOffsets[e],j=this.fileDirectory.TileByteCounts[e]):(i=this.fileDirectory.StripOffsets[e],j=this.fileDirectory.StripByteCounts[e]);var k=this.dataView.buffer.slice(i,i+j);if(d)return this.getDecoder().decodeBlockAsync(k,function(f,g){f||null===h||(h[e]=g),d(f,{x:a,y:b,sample:c,data:g})});var l=this.getDecoder().decodeBlock(k);return null!==h&&(h[e]=l),l},_readRasterAsync:function(a,b,c,d,e,f){function g(){v&&0===w&&(y?f(y):e(c))}function h(e,f){if(e)y=e;else for(var h=new DataView(f.data),k=f.y*j,l=f.x*i,m=(f.y+1)*j,n=(f.x+1)*i,o=f.sample,u=Math.max(0,a[1]-k);u<Math.min(j,j-(m-a[3]));++u)for(var v=Math.max(0,a[0]-l);v<Math.min(i,i-(n-a[2]));++v){var z,A=(u*i+v)*q,B=t[o].call(h,A+s[o],x);d?(1!==r&&v>0&&(z=(u+k-a[1])*p*b.length+(v+l-a[0]-1)*b.length+o,B+=c[z]),z=(u+k-a[1])*p*b.length+(v+l-a[0])*b.length+o,c[z]=B):(1!==r&&v>0&&(z=(u+k-a[1])*p+v-1+l-a[0],B+=c[o][z]),z=(u+k-a[1])*p+v+l-a[0],c[o][z]=B)}w-=1,g()}for(var i=this.getTileWidth(),j=this.getTileHeight(),l=Math.floor(a[0]/i),m=Math.ceil(a[2]/i),n=Math.floor(a[1]/j),o=Math.ceil(a[3]/j),p=(Math.ceil(this.getWidth()/i),a[2]-a[0]),q=(a[3]-a[1],this.getBytesPerPixel()),r=(this.getWidth(),this.fileDirectory.Predictor||1),s=[],t=[],u=0;u<b.length;++u)1===this.planarConfiguration?s.push(k(this.fileDirectory.BitsPerSample,0,b[u])/8):s.push(0),t.push(this.getReaderForSample(b[u]));for(var v=!1,w=0,x=this.littleEndian,y=null,z=n;z<=o;++z)for(var A=l;A<=m;++A)for(var B=0;B<b.length;++B){var C=b[B];2===this.planarConfiguration&&(q=this.getSampleByteSize(C));w+=1,this.getTileOrStrip(A,z,C,h)}v=!0,g()},_readRaster:function(a,b,c,d,e,f){try{for(var g=this.getTileWidth(),h=this.getTileHeight(),i=Math.floor(a[0]/g),j=Math.ceil(a[2]/g),l=Math.floor(a[1]/h),m=Math.ceil(a[3]/h),n=(Math.ceil(this.getWidth()/g),a[2]-a[0]),o=(a[3]-a[1],this.getBytesPerPixel()),p=(this.getWidth(),this.fileDirectory.Predictor||1),q=[],r=[],s=0;s<b.length;++s)1===this.planarConfiguration?q.push(k(this.fileDirectory.BitsPerSample,0,b[s])/8):q.push(0),r.push(this.getReaderForSample(b[s]));for(var t=l;t<m;++t)for(var u=i;u<j;++u)for(var v=t*h,w=u*g,x=(t+1)*h,y=(u+1)*g,z=0;z<b.length;++z){var A=b[z];2===this.planarConfiguration&&(o=this.getSampleByteSize(A));var B=new DataView(this.getTileOrStrip(u,t,A)),C=r[z],D=Math.min(h,h-(x-a[3])),E=Math.min(g,g-(y-a[2])),F=(D*g+E)*o,G=new Uint8Array(B.buffer).length;2*G!==F&&this._debugMessages&&console.warn("dimension mismatch",G,F);for(var H=Math.max(0,a[1]-v);H<D;++H)for(var I=Math.max(0,a[0]-w);I<E;++I){var J=(H*g+I)*o,K=0;J<G-1&&(K=C.call(B,J+q[z],this.littleEndian));var L;d?(1!==p&&I>0&&(L=(H+v-a[1])*n*b.length+(I+w-a[0]-1)*b.length+z,K+=c[L]),L=(H+v-a[1])*n*b.length+(I+w-a[0])*b.length+z,c[L]=K):(1!==p&&I>0&&(L=(H+v-a[1])*n+I-1+w-a[0],K+=c[z][L]),L=(H+v-a[1])*n+I+w-a[0],c[z][L]=K)}}return e(c),c}catch(a){return f(a)}},readRasters:function(){var a,b,c;switch(arguments.length){case 0:break;case 1:"function"==typeof arguments[0]?b=arguments[0]:a=arguments[0];break;case 2:"function"==typeof arguments[0]?(b=arguments[0],c=arguments[1]):(a=arguments[0],b=arguments[1]);break;case 3:a=arguments[0],b=arguments[1],c=arguments[2];break;default:throw new Error("Invalid number of arguments passed.")}a=a||{},c=c||function(a){console.error(a)};var d=a.window||[0,0,this.getWidth(),this.getHeight()],e=a.samples,f=a.interleave;if(d[0]<0||d[1]<0||d[2]>this.getWidth()||d[3]>this.getHeight())throw new Error("Select window is out of image bounds.");if(d[0]>d[2]||d[1]>d[3])throw new Error("Invalid subsets");var g,h=d[2]-d[0],i=d[3]-d[1],j=h*i;if(e){for(g=0;g<e.length;++g)if(e[g]>=this.fileDirectory.SamplesPerPixel)throw new RangeError("Invalid sample index '"+e[g]+"'.")}else for(e=[],g=0;g<this.fileDirectory.SamplesPerPixel;++g)e.push(g);var k;if(f){var m=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,n=Math.max.apply(null,this.fileDirectory.BitsPerSample);k=l(m,n,j*e.length)}else for(k=[],g=0;g<e.length;++g)k.push(this.getArrayForSample(e[g],j));var o=this.getDecoder();if(o.isAsync()){if(!b)throw new Error("No callback specified for asynchronous raster reading.");return this._readRasterAsync(d,e,k,f,b,c)}return b=b||function(){},this._readRaster(d,e,k,f,b,c)},readRGB:function(){var a=null,b=null,c=null;switch(arguments.length){case 0:break;case 1:"function"==typeof arguments[0]?b=arguments[0]:a=arguments[0];break;case 2:"function"==typeof arguments[0]?(b=arguments[0],c=arguments[1]):(a=arguments[0],b=arguments[1]);break;case 3:a=arguments[0],b=arguments[1],c=arguments[2];break;default:throw new Error("Invalid number of arguments passed.")}a=a||{},c=c||function(a){console.error(a)};var d=a.window||[0,0,this.getWidth(),this.getHeight()];if(d[0]<0||d[1]<0||d[2]>this.getWidth()||d[3]>this.getHeight())throw new Error("Select window is out of image bounds.");if(d[0]>d[2]||d[1]>d[3])throw new Error("Invalid subsets");var g=d[2]-d[0],h=d[3]-d[1],i=this.fileDirectory.PhotometricInterpretation,j=this.fileDirectory.BitsPerSample[0],k=Math.pow(2,j);if(i===e.photometricInterpretations.RGB)return this.readRasters({window:a.window,interleave:!0},b,c);var l;switch(i){case e.photometricInterpretations.WhiteIsZero:case e.photometricInterpretations.BlackIsZero:case e.photometricInterpretations.Palette:l=[0];break;case e.photometricInterpretations.CMYK:l=[0,1,2,3];break;case e.photometricInterpretations.YCbCr:case e.photometricInterpretations.CIELab:l=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}var m={window:a.window,interleave:!0,samples:l},n=this.fileDirectory;return this.readRasters(m,function(a){switch(i){case e.photometricInterpretations.WhiteIsZero:return b(f.fromWhiteIsZero(a,k,g,h));case e.photometricInterpretations.BlackIsZero:return b(f.fromBlackIsZero(a,k,g,h));case e.photometricInterpretations.Palette:return b(f.fromPalette(a,n.ColorMap,g,h));case e.photometricInterpretations.CMYK:return b(f.fromCMYK(a,g,h));case e.photometricInterpretations.YCbCr:return b(f.fromYCbCr(a,g,h));case e.photometricInterpretations.CIELab:return b(f.fromCIELab(a,g,h))}},c)},getTiePoints:function(){if(!this.fileDirectory.ModelTiepoint)return[];for(var a=[],b=0;b<this.fileDirectory.ModelTiepoint.length;b+=6)a.push({i:this.fileDirectory.ModelTiepoint[b],j:this.fileDirectory.ModelTiepoint[b+1],k:this.fileDirectory.ModelTiepoint[b+2],x:this.fileDirectory.ModelTiepoint[b+3],y:this.fileDirectory.ModelTiepoint[b+4],z:this.fileDirectory.ModelTiepoint[b+5]});return a},getGDALMetadata:function(){var a={};if(!this.fileDirectory.GDAL_METADATA)return null;for(var b=this.fileDirectory.GDAL_METADATA,c=e.parseXml(b.substring(0,b.length-1)),d=c.evaluate("GDALMetadata/Item",c,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null),f=0;f<d.snapshotLength;++f){var g=d.snapshotItem(f);a[g.getAttribute("name")]=g.textContent}return a}},b.exports=d},{"./compression/deflate.js":2,"./compression/lzw.js":3,"./compression/packbits.js":4,"./compression/raw.js":5,"./globals.js":9,"./rgb.js":11}],9:[function(a,b,c){"use strict";var d,e={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams"},f={};for(d in e)f[e[d]]=parseInt(d);var g=[f.BitsPerSample,f.ExtraSamples,f.SampleFormat,f.StripByteCounts,f.StripOffsets,f.StripRowCounts,f.TileByteCounts,f.TileOffsets],h={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",16:"LONG8",17:"SLONG8",18:"IFD8"},i={};for(d in h)i[h[d]]=parseInt(d);var j={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},k={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},l={};for(d in k)l[k[d]]=parseInt(d);var m;"undefined"==typeof window?m=function(b){var c=a("xmldom").DOMParser;return(new c).parseFromString(b,"text/xml")}:"undefined"!=typeof window.DOMParser?m=function(a){return(new window.DOMParser).parseFromString(a,"text/xml")}:"undefined"!=typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")&&(m=function(a){var b=new window.ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b}),b.exports={fieldTags:f,fieldTagNames:e,arrayFields:g,fieldTypes:i,fieldTypeNames:h,photometricInterpretations:j,geoKeys:l,geoKeyNames:k,parseXml:m}},{xmldom:"xmldom"}],10:[function(a,b,c){"use strict";var d=a("./geotiff.js"),e=function(a,b){var c,e,f,g;if("string"==typeof a||a instanceof String)for(c=new ArrayBuffer(2*a.length),g=new Uint16Array(c),e=0,f=a.length;e<f;++e)g[e]=a.charCodeAt(e);else{if(!(a instanceof ArrayBuffer))throw new Error("Invalid input data given.");c=a}return new d(c,b)};"undefined"!=typeof b&&"undefined"!=typeof b.exports&&(b.exports.parse=e),"undefined"!=typeof window&&(window.GeoTIFF={parse:e})},{"./geotiff.js":7}],11:[function(a,b,c){"use strict";function d(a,b,c,d){for(var e,f=new Uint8Array(c*d*3),g=0,h=0;g<a.length;++g,h+=3)e=256-a[g]/b*256,f[h]=e,f[h+1]=e,f[h+2]=e;return f}function e(a,b,c,d){for(var e,f=new Uint8Array(c*d*3),g=0,h=0;g<a.length;++g,h+=3)e=a[g]/b*256,f[h]=e,f[h+1]=e,f[h+2]=e;return f}function f(a,b,c,d){for(var e=new Uint8Array(c*d*3),f=b.length/3,g=b.length/3*2,h=0,i=0;h<a.length;++h,i+=3){var j=a[h];e[i]=b[j]/65536*256,e[i+1]=b[j+f]/65536*256,e[i+2]=b[j+g]/65536*256}return e}function g(a,b,c){for(var d,e,f,g,h=new Uint8Array(b*c*3),i=0,j=0;i<a.length;i+=4,j+=3)d=a[i],e=a[i+1],f=a[i+2],g=a[i+3],h[j]=255*((255-d)/256)*((255-g)/256),h[j+1]=255*((255-e)/256)*((255-g)/256),h[j+2]=255*((255-f)/256)*((255-g)/256);return h}function h(a,b,c){for(var d,e,f,g=new Uint8Array(b*c*3),h=0,i=0;h<a.length;h+=3,i+=3)d=a[h],e=a[h+1],f=a[h+2],g[i]=d+1.402*(f-128),g[i+1]=d-.34414*(e-128)-.71414*(f-128),g[i+2]=d+1.772*(e-128);return g}function i(a,b,c){for(var d,e,f,g,h,i,j,k,l,m,n,o,p=.008856,q=.206893,r=[3.240479,-1.53715,-.498535,-.969256,1.875992,.041556,.055648,-.204043,1.057311],s=new Uint8Array(b*c*3),t=0,u=0;t<a.length;t+=3,u+=3)d=a[t],e=a[t+1],f=a[t+2],h=Math.pow((d+16)/116,3),k=h>p,h=(0!==k)*(d/903.3)+k*h,n=h,h=k*Math.pow(h,1/3)+(0!==k)*(7.787*h+16/116),g=e/500+h,j=g>q,m=j*Math.pow(g,3)+(0!==j)*((g-16/116)/7.787),i=h-f/200,l=i>q,o=l*Math.pow(i,3)+(0!==l)*((i-16/116)/7.787),m*=.950456,o*=1.088754,s[u]=m*r[0]+n*r[1]+o*r[2],s[u+1]=m*r[3]+n*r[4]+o*r[5],s[u+2]=m*r[6]+n*r[7]+o*r[8];return s}b.exports={fromWhiteIsZero:d,fromBlackIsZero:e,fromPalette:f,fromCMYK:g,fromYCbCr:h,fromCIELab:i}},{}]},{},[10]);